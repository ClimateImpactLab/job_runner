# This file was autogenerated and will overwrite each time you run travis_pypi_setup.py
after_success:
- coveralls
deploy:
  true:
    python: 2.7
    repo: ClimateImpactLab/jrnr
  on:
    branch: master
  distributions: sdist bdist_wheel
  user: justin_gerard
  provider: pypi
  password:
    secure: !!binary |
      TUdveEVoVzRqYXp5MW1FSE9nUEl2Nzh2WUNPeHpFSzBuQlRhR1JtZU1BdTY0MjBuRnJKN2tnVjdv
      S2Q2NTl5a2RxY1l5a1F1bXVsMWVmZ0tLYTM2VWdFU1BQNVFhaWVuTzNnRFRxNEJUdW9wTnNyZUdJ
      Yys2TWFubnZnaVZNSlJzSXhiaVBWdzhsNXBTcHladzRsejkraGoyT3FrdzM4eXJOYjJxL3hCSUtE
      M1ExalRGT01QRGlWV0F4d1NNYlBsUVI3bFhaOEVtZmlTVkNtQjBiQnQ5dEZXSDg5TC8wamJPWUUy
      RDFnT1Ira0VuLzFabHVGTXB2c0FtaWJSN0VTWXV1Z3I0SmROUlcyODF3Sk0yZ2lSUmRMdWM5dEhS
      MFFzd3ZCM0dHZ1c4ZVlWQzF3OThIMjgva0RETzlNNnRtbnk2NUJpWENQK1dLamlUc21vT29XQ0Jn
      d2puSUlRWitHeW80YzFaWG5wc1hhOEsvU05xVFpMdnp4NVQ4cVZ4RUxRWEppVFdiczVLVUt3TUh5
      eXQveHBRQjhGREJGRG4vdjRidVJrZ2xOZHA4ZkZIM3RqOUdqNjZuaEhrRjlFd09oN3RxVjE2K0wr
      NDM0TjFFS3BGci8rSUtSTEhGZ1VHZ3FqbllnbzZqUFk3SDUxa1p5T1lEcWdRMXE2Y2N0RE14VytM
      OTVIVGZhMkxNN2w2TCt5MVk1dVVOOGRBcXRmdGtwcUcyWGJJamtySkN0WWRWTENjYnBMODk2WUtK
      c1F2Vk9PSENKY2tUR2JhZmhjZlA5aXU2ODV6SGRUNExpWGlqeVpOUmhKTm5RZklOd0Q1T3c5RSsy
      ODdLT2IyRkhNUUs5Zko5NXRPSGV5SVF3QnB5emFZVWs1SElKQzJxQmUwSkw0OE9mdWhZK2VrOUk9
env:
  matrix:
  - TEST_ENV=tox
  - TEST_ENV=conda
install:
- pip install --upgrade pip
- if [[ "$TEST_ENV" == "conda" ]]; then
    if [[ "$TRAVIS_PYTHON_VERSION" == "2.7" ]]; then
      wget https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh -O miniconda.sh;
    else
      wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh;
    fi;
    
    bash miniconda.sh -b -p $HOME/miniconda;
    export PATH="$HOME/miniconda/bin:$PATH";
    hash -r;
    conda config --set always_yes yes --set changeps1 no;
    conda update -q conda;
    conda config --add channels conda-forge;
    conda info -a;

    conda create -q -n test-env python=$TRAVIS_PYTHON_VERSION;
    source activate test-env;

    python setup.py install;
    python -m pip install -r requirements_dev.txt;
    conda install --yes --file requirements_conda.txt;

  else
    pip install -U tox-travis;
  fi

language: python
matrix:
  allow_failures:
  - env: TEST_ENV=conda
    python: 3.4
python:
- 3.5
- 3.4
- 2.7
script:
- if [[ "$TEST_ENV" == "conda" ]]; then
    export PATH="$HOME/miniconda/bin:$PATH";
    source activate test-env;
    python -m pytest;
    sphinx-apidoc -o docs jrnr;
    sphinx-build -W -b html -d docs/_build/doctrees docs/. docs/_build/html;
  else
    tox;
  fi;
